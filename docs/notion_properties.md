# Notionタスクデータベース プロパティ一覧

このドキュメントは、`tests/check_task_database_properties.py` スクリプトで取得した情報を基に作成されています。

## データベース情報

- **データベース名**: AchieveシェアタスクDB
- **Database ID**: `26e7cde2-03d4-805a-9445-d650a35daf4a`
- **作成日時**: 2025-09-14T11:15:00.000Z

## プロパティ一覧（全25個）

### 1. 基本情報

| プロパティ名 | 型 | 説明 | 使用箇所 |
|-------------|-----|------|---------|
| タイトル | title | タスクのタイトル（必須） | タスク作成時 |
| 依頼者 | people | タスクを依頼した人 | タスク作成時 |
| 依頼先 | people | タスクの担当者 | タスク作成時 |
| 納期 | date | タスクの納期 | タスク作成時、リマインド判定 |
| タスク種類 | select | タスクの分類 | タスク作成時 |
| 緊急度 | select | タスクの優先度 | タスク作成時 |

**タスク種類の選択肢**:
- フリーランス関係
- モノテック関連
- 社内タスク
- HH関連
- Sales関連
- PL関連

**緊急度の選択肢**:
- ノンコア社内タスク
- 1週間以内
- 最重要

### 2. ステータス管理

| プロパティ名 | 型 | 選択肢 | 説明 |
|-------------|-----|--------|------|
| ステータス | select | 承認待ち, 承認済み, 差し戻し, 完了, 無効 | タスクの承認状態 |
| 完了ステータス | select | 進行中, 完了申請中, 完了承認, 完了却下 | タスクの完了承認状態 |
| 延期ステータス | select | なし, 申請中, 承認済み, 却下, 承認済 | 納期延期の申請状態 |

### 3. 承認・申請関連の日時

| プロパティ名 | 型 | 説明 | 使用箇所 |
|-------------|-----|------|---------|
| 完了申請日時 | date | 完了申請がされた日時 | 完了申請時、完了承認リマインド判定 |
| 完了承認日時 | date | 完了承認された日時 | 完了承認時 |
| 延期申請日時 | date | 延期申請がされた日時 | 延期申請時、延期承認リマインド判定 |
| 延期期日（申請中） | date | 申請中の延期後の納期 | 延期申請時 |

### 4. 承認・完了の詳細情報

| プロパティ名 | 型 | 説明 |
|-------------|-----|------|
| 差し戻し理由 | rich_text | タスクが差し戻された理由 |
| 完了報告メモ | rich_text | 完了申請時のメモ |
| 完了却下理由 | rich_text | 完了が却下された理由 |
| 延期理由（申請中） | rich_text | 延期申請の理由 |

### 5. リマインド機能関連

| プロパティ名 | 型 | 説明 | 使用箇所 |
|-------------|-----|------|---------|
| リマインドフェーズ | select | リマインドの状態 | リマインド管理 |
| 最終リマインド日時 | date | 最後にリマインドを送信した日時 | 納期リマインド |
| 承認リマインド最終送信日時 | date | 最後に承認リマインドを送信した日時 | 承認リマインド（6時間判定） |
| 最終既読日時 | date | 最後に既読された日時 | リマインド管理 |
| リマインド既読 | checkbox | リマインドが既読されたか | リマインド管理 |
| 当日既読 | checkbox | 当日リマインドが既読されたか | リマインド管理 |
| 超過既読 | checkbox | 超過リマインドが既読されたか | リマインド管理 |

**リマインドフェーズの選択肢**:
- 未承認
- 未送信
- 期日前
- 当日
- 超過
- 既読

### 6. メトリクス

| プロパティ名 | 型 | 説明 |
|-------------|-----|------|
| 納期超過ポイント | number | 納期超過のペナルティポイント |

## 承認待ちリマインド機能で使用するプロパティ

### タスク承認待ちリマインド
- **判定条件**: `ステータス` = "承認待ち"
- **基準日時**: ページの `created_time` (Notion APIの標準フィールド)
- **リマインド記録**: `承認リマインド最終送信日時`
- **送信先**: `依頼先` (承認者) と `依頼者`

### 完了承認待ちリマインド
- **判定条件**: `完了ステータス` = "完了申請中"
- **基準日時**: `完了申請日時`
- **リマインド記録**: `承認リマインド最終送信日時`
- **送信先**: `依頼者` (承認者) と `依頼先`

### 延期承認待ちリマインド
- **判定条件**: `延期ステータス` = "申請中"
- **基準日時**: `延期申請日時`
- **リマインド記録**: `承認リマインド最終送信日時`
- **送信先**: `依頼者` (承認者) と `依頼先`

## コード内の定数とプロパティ名の対応

以下は `src/infrastructure/notion/dynamic_notion_service.py` で定義されている定数と実際のNotionプロパティ名の対応表です：

```python
# 基本プロパティ
TASK_PROP_TITLE = "タイトル"
TASK_PROP_DUE_DATE = "納期"
TASK_PROP_REQUESTER = "依頼者"
TASK_PROP_ASSIGNEE = "依頼先"

# ステータス関連
TASK_PROP_STATUS = "ステータス"
TASK_STATUS_PENDING = "承認待ち"
TASK_STATUS_APPROVED = "承認済み"
TASK_STATUS_REJECTED = "差し戻し"
TASK_STATUS_COMPLETED = "完了"
TASK_STATUS_DISABLED = "無効"

# 完了ステータス
TASK_PROP_COMPLETION_STATUS = "完了ステータス"
COMPLETION_STATUS_IN_PROGRESS = "進行中"
COMPLETION_STATUS_REQUESTED = "完了申請中"
COMPLETION_STATUS_APPROVED = "完了承認"
COMPLETION_STATUS_REJECTED = "完了却下"

# 延期ステータス
TASK_PROP_EXTENSION_STATUS = "延期ステータス"
EXTENSION_STATUS_NONE = "なし"
EXTENSION_STATUS_PENDING = "申請中"
EXTENSION_STATUS_APPROVED = "承認済み"
EXTENSION_STATUS_REJECTED = "却下"

# 日時プロパティ
TASK_PROP_COMPLETION_REQUESTED_AT = "完了申請日時"
TASK_PROP_EXTENSION_REQUESTED_AT = "延期申請日時"
TASK_PROP_APPROVAL_REMINDER_AT = "承認リマインド最終送信日時"
TASK_PROP_LAST_REMINDER_AT = "最終リマインド日時"

# その他
TASK_PROP_REJECTION_REASON = "差し戻し理由"
TASK_PROP_COMPLETION_MEMO = "完了報告メモ"
TASK_PROP_EXTENSION_REASON = "延期理由（申請中）"
TASK_PROP_EXTENSION_NEW_DUE_DATE = "延期期日（申請中）"
```

## プロパティ更新時の注意事項

1. **プロパティ名の変更**: コード内の定数も合わせて更新する必要があります
2. **選択肢の追加・変更**: 既存の値を使用しているタスクへの影響を考慮してください
3. **必須プロパティ**: タイトル、依頼者、依頼先、納期は必須です

## プロパティ確認コマンド

プロパティ一覧を再確認する場合は、以下のコマンドを実行してください：

```bash
uv run python tests/check_task_database_properties.py
```

このスクリプトは以下の情報を出力します：
- 全プロパティの一覧と型
- 選択肢の一覧（select/status型の場合）
- 承認待ち関連プロパティの存在確認
- サンプルタスクの内容
- JSON形式のプロパティ構造

---

**最終更新日**: 2025-10-02
**更新者**: check_task_database_properties.py により自動取得
